<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<title>分类</title>
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet" th:href="@{/layui/css/layui.css}" media="all">
<script th:src="@{/layui/layui.js}"></script>
<script type="text/javascript">

layui.use(['form', 'layedit', 'laydate', 'jquery'],
function() {
    var form = layui.form;
    var $ = layui.jquery;
    var layer = layui.layer;
    var layedit = layui.layedit;
    var laydate = layui.laydate;
    var id = '[[${#httpServletRequest.getParameter('id')}]]'; //获取传过来的id值
    var typeName = '[[${#httpServletRequest.getParameter('typeName')}]]'; //获取传过来的类型名称值
    var orderNum = '[[${#httpServletRequest.getParameter('orderNum')}]]'; //获取传过来的序列值
    if(id!=null) {
    	$("#idd").val(id);
    }
    $("#typename").val(typeName);
    $("#ordernum").val(orderNum);
    //自定义验证规则  
    form.verify({
        typename: function(value) {
            if (value.length < 2) {
                return '标题至少得2个字符';
            }
        },
        ordernum: [/^[1-9][0-9]{0,1}$/, '只能是1-99位的数字！']
    });
    form.on('submit(demo1)',
    function(data) {
        //获取博客标题
        var idd = data.field["idd"]
        //获取博客类别id
        var typename = data.field["typename"]
        var ordernum = data.field["ordernum"] 
		$.ajax({
            async: false,
            url: '../admin/blogType/save',
            data: {
                'id': idd,
                'typeName': typename,
                'orderNum': ordernum,
            },
            type: 'post',
            success: function(result) {
          		if(typeof result === 'string') {
					 result = JSON.parse(result)
				 }
                if (result.success) {
                    layer.alert('操作成功！', {
                        title: '系统提示',
                        icon: 6,
                        closeBtn: 0,
                    },
                    function(index) {
						parent.location.reload(); // 父页面刷新                   
                        layer.close(index); //关闭
                    });
                } else {
                    layer.alert('操作失败。。。', {
                        title: '系统提示',
                        icon: 5,
                        closeBtn: 0,
                    },
                    function(index) {
                   		parent.location.reload(); // 父页面刷新                
                        layer.close(index); //关闭
                    });
                }
            } // end success
        }); //end ajax
        return false;
    }); //end form.on
});
</script>
</head>
<body>
	<form class="layui-form" action="" id="demo1">
		<div class="layui-form-item">
			<!-- id无法修改  -->
			<input type="hidden" id="idd" name="idd" value=""> <label
				class="layui-form-label">分类名称：</label>
			<div class="layui-input-block"
				style="width: 200px; margin-top: 15px;">
				<input type="text" name="typename" required lay-verify="typename"
					placeholder="分类名称" autocomplete="off" class="layui-input"
					id="typename" value="">
			</div>
		</div>
		<div class="layui-form-item">
			<label class="layui-form-label">分类序号：</label>
			<div class="layui-input-block" style="width: 200px">
				<input type="text" name="ordernum" required lay-verify="ordernum"
					placeholder="分类序号" autocomplete="off" class="layui-input"
					id="ordernum" value="">
			</div>
		</div>

		<div class="layui-form-item">
			<div class="layui-input-block">
				<button class="layui-btn" lay-submit="" lay-filter="demo1">确定</button>
				<button type="reset" class="layui-btn layui-btn-primary">清空</button>
			</div>
		</div>
	</form>
</body>
</html>